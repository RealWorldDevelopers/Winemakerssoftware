function CelsiusToFahrenheit(n){try{return 9/5*n+32}catch(t){console.error(t)}}function FahrenheitToCelsius(n){try{return(n-32)*5/9}catch(t){console.error(t)}}function PoundsToKilograms(n){try{return n*.45359237}catch(t){console.error(t)}}function OuncesToGrams(n){try{return n*28.3495231}catch(t){console.error(t)}}function GramsToOunces(n){try{return n*.0352739619}catch(t){console.error(t)}}function OuncesToPounds(n){try{return n*.0625}catch(t){console.error(t)}}function PoundsToOunces(n){try{return n*16}catch(t){console.error(t)}}function MilligramsToGrams(n){try{return n*.001}catch(t){console.error(t)}}function GramsToKilograms(n){try{return n*.001}catch(t){console.error(t)}}function GramsToMilligrams(n){try{return n*1e3}catch(t){console.error(t)}}function KilogramsToGrams(n){try{return n*1e3}catch(t){console.error(t)}}function MillilitersToTeaspoons(n){try{return n*.202884136}catch(t){console.error(t)}}function MillilitersToTablespoons(n){try{return n*.0676280454}catch(t){console.error(t)}}function MillilitersToFluidOunces(n){try{return n*.0338140227}catch(t){console.error(t)}}function LitersToQuarts(n){try{return n*1.05668821}catch(t){console.error(t)}}function LitersToGallons(n){try{return n*.264172052}catch(t){console.error(t)}}function MillilitersToLiters(n){try{return n*.001}catch(t){console.error(t)}}function LitersToMilliliters(n){try{return n*1e3}catch(t){console.error(t)}}function TablespoonToTeaspoon(n){try{return n*3}catch(t){console.error(t)}}function TeaspoonToTablespoon(n){try{return n/3}catch(t){console.error(t)}}function TeaspoonToFluidOunces(n){try{return n*.166666667}catch(t){console.error(t)}}function TablespoonToFluidOunces(n){try{return n*.5}catch(t){console.error(t)}}function FluidOuncesToLiters(n){try{return n*.0295735296}catch(t){console.error(t)}}function FluidOuncesToMilliliters(n){try{return n*29.5735296}catch(t){console.error(t)}}function FluidOuncesToCups(n){try{return n*.125}catch(t){console.error(t)}}function FluidOuncesToPints(n){try{return n*.0625}catch(t){console.error(t)}}function FluidOuncesToQuarts(n){try{return n*.03125}catch(t){console.error(t)}}function FluidOuncesToGallons(n){try{return n*.0078125}catch(t){console.error(t)}}function FluidOuncesToTeaspoons(n){try{return n*6}catch(t){console.error(t)}}function FluidOuncesToTablespoons(n){try{return n*2}catch(t){console.error(t)}}function CupsToQuarts(n){try{return n*.25}catch(t){console.error(t)}}function CupsToPints(n){try{return n*.5}catch(t){console.error(t)}}function CupsToFluidOunces(n){try{return n*8}catch(t){console.error(t)}}function QuartsToLiters(n){try{return n*.946352946}catch(t){console.error(t)}}function QuartsToGallons(n){try{return n*.25}catch(t){console.error(t)}}function PintsToQuarts(n){try{return n*.5}catch(t){console.error(t)}}function PintsToCups(n){try{return n*2}catch(t){console.error(t)}}function GallonsToCups(n){try{return n*16}catch(t){console.error(t)}}function GallonsToQuarts(n){try{return n*4}catch(t){console.error(t)}}function ConvertSGtoBrix(n){try{return((182.4601*n-775.6821)*n+1262.7794)*n-669.5622}catch(t){console.error(t)}}function ConvertBrixToSG(n){try{return n/(258.6-n/258.2*227.1)+1}catch(t){console.error(t)}}function deleteBatchEntry(n,t){var i=$("#BatchJwt").val();$.ajax({url:rootUri+"/api/journal/batchEntry/"+n,type:"POST",headers:{Authorization:"Bearer "+i},contentType:"application/json",success:function(){console.log("successful deletion batch entry");t.addClass("d-none")},error:function(n,t,i){alert("something went wrong");console.log("Exception: "+i)}})}function addBatchEntry(n){var e,o,c,t,s,i,h,r,u,f,l,a;localStorage.removeItem("latestEntryAdded");e=new Date(Date.now());$("#batchEntryModal_actionDate").val()&&(o=new Date($("#batchEntryModal_actionDate").val().replace(/-/g,"/")),c=new Date,c.setDate(e.getDate()-30),o<Date.now()&&o>c&&(e=o));t=parseFloat($("#batchEntryModal_temp").val());(!$.isNumeric(t)||t>90||t<0)&&(t=null);s=parseInt($('input[name="optEntryTemp"]:checked').val());Number.isInteger(s)||(s=null);i=parseFloat($("#batchEntryModal_sugar").val());(!$.isNumeric(i)||i>30||i<.8)&&(i=null);h=parseInt($('input[name="optEntrySugar"]:checked').val());Number.isInteger(h)||(h=null);r=parseFloat($("#batchEntryModal_ph").val());(!$.isNumeric(r)||r>30||r<.8)&&(r=null);u=parseFloat($("#batchEntryModal_ta").val());(!$.isNumeric(u)||u>30||u<.8)&&(u=null);f=parseFloat($("#batchEntryModal_so2").val());(!$.isNumeric(f)||f>30||f<.8)&&(f=null);l=$("#BatchJwt").val();a={Racked:$("#batchEntryModal_racked").is(":checked"),Filtered:$("#batchEntryModal_filtered").is(":checked"),Bottled:$("#batchEntryModal_bottled").is(":checked"),ActionDateTime:e,Temp:t,TempUomId:s,Sugar:i,SugarUomId:h,pH:r,Ta:u,So2:f,Additions:$("#batchEntryModal_additions").val(),Comments:$("#batchEntryModal_comments").val()};$.ajax({url:rootUri+"/api/journal/batchEntry/"+n,type:"PUT",headers:{Authorization:"Bearer "+l},contentType:"application/json",data:JSON.stringify(a),success:function(n){localStorage.setItem("latestEntryAdded",JSON.stringify(n));console.log("successful batch entry created");$(".toast").toast({delay:2e3});$(".toast").toast("show");$(".toast").on("hidden.bs.toast",function(){$("#batchEntryModal").modal("hide")})},error:function(n,t,i){alert("something went wrong");console.log("Exception: "+i)}})}function getStatusChart(n){var t=$("#BatchJwt").val();$.ajax({url:rootUri+"/api/journal/batchChart/"+n,type:"GET",headers:{Authorization:"Bearer "+t},contentType:"application/json",success:function(n){var r=n.times,u=n.temp,f=n.sugar,t="rgba(255,0,0,1)",i="rgba(0,0,255,1)",e={type:"line",data:{labels:r,datasets:[{label:"Sugar",backgroundColor:i,borderColor:i,data:f,yAxisID:"y-axis-1",fill:!1},{label:"Temp",fill:!1,backgroundColor:t,borderColor:t,yAxisID:"y-axis-2",data:u}]},options:{responsive:!0,title:{display:!0,text:"Fermentation"},tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0},scales:{xAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Date"}}],yAxes:[{type:"linear",display:!0,position:"left",id:"y-axis-1",scaleLabel:{display:!0,labelString:"Sugar"}},{type:"linear",display:!0,position:"right",id:"y-axis-2",scaleLabel:{display:!0,labelString:"Temp"}}]}}},o=$("#statusChart");statusChart=new Chart(o,e)},error:function(n,t,i){console.log("Chart Data Exception: "+i)}})}function showAddEntry(n){$("#batchEntryModal_id").val(n);$("#batchEntryModal").modal()}function addToChart(n){var t,i,r;n?statusChart?(t=void 0,n.actionDateTime&&(t=n.actionDateTime),t?(i=void 0,n.sugarUom&&(i=n.sugarUom==="Brix"?ConvertBrixToSG(n.sugar):n.sugar),i?(r=void 0,n.tempUom&&(r=n.tempUom==="C"?CelsiusToFahrenheit(n.temp):n.temp),r?(statusChart.data.labels.push(formatDate(t)),statusChart.data.datasets[0].data.push(i),statusChart.data.datasets[1].data.push(r),statusChart.update()):console.log("Chart Update Missing Temp Data")):console.log("Chart Update Missing Sugar Data")):console.log("Chart Update Missing Activity Date")):console.log("Chart Update No Chart Created"):console.log("Chart Update No Chart Data")}function updateStatus(n){n.racked===!0&&($("#summaryRacked").removeClass("d-none"),$("#summaryRackedOnDate").html(formatDate(n.actionDateTime)));n.filtered&&($("#summaryFiltered").removeClass("d-none"),$("#summaryFilteredOnDate").html(formatDate(n.actionDateTime)));n.bottled&&($("#summaryBotted").removeClass("d-none"),$("#summaryBottedOnDate").html(formatDate(n.actionDateTime)));n.sugarUom&&($("#summarySugar").removeClass("d-none"),$("#summarySugarOnValue").html(n.sugar),$("#summarySugarOnUom").html(n.sugarUom),$("#summarySugarOnDate").html(formatDate(n.actionDateTime)));n.tempUom&&($("#summaryTemp").removeClass("d-none"),$("#summaryTempOnValue").html(n.temp),$("#summaryTempOnUom").html(n.tempUom),$("#summaryTempOnDate").html(formatDate(n.actionDateTime)));n.so2&&($("#summarySo2").removeClass("d-none"),$("#summarySo2OnValue").html(n.so2),$("#summarySo2OnDate").html(formatDate(n.actionDateTime)));n.pH&&($("#summarypH").removeClass("d-none"),$("#summarypHOnValue").html(n.pH),$("#summarypHOnDate").html(formatDate(n.actionDateTime)));n.ta&&($("#summaryTa").removeClass("d-none"),$("#summaryTaOnValue").html(n.ta),$("#summaryTaOnDate").html(formatDate(n.actionDateTime)));n.comments&&($("#summaryComments").removeClass("d-none"),$("#summaryCommentsOnValue").html(n.comments),$("#summaryCommentsOnDate").html(formatDate(n.actionDateTime)))}function buildDisplayEntry(n){if(n){const o=document.createElement("div");o.className="card flex-grow-1";const i=document.createElement("div");i.className="card-body";var t=new Date(n.entryDateTime);n.actionDateTime&&(t=new Date(n.actionDateTime));const e=document.createElement("div");e.className="d-flex card-title h5";e.innerHTML=formatDateTime(t)+"&nbsp;";const s=document.createElement("i");s.className="fa fa-trash-o";const u=document.createElement("button");u.className="btn btn-outline-secondary btn-sm";u.setAttribute("name","delBatchEntryButton");u.setAttribute("data-id",n.id);u.appendChild(s);e.appendChild(u);i.appendChild(e);const r=document.createElement("div");if(r.className="d-flex ml-3",n.sugar&&n.sugarUom){const t=document.createElement("div");t.className="p-2";t.innerHTML="<strong>"+n.sugarUom+"<\/strong>: "+n.sugar;r.appendChild(t)}if(n.pH){const t=document.createElement("div");t.className="p-2";t.innerHTML="<strong>pH<\/strong>: "+n.pH;r.appendChild(t)}if(n.ta){const t=document.createElement("div");t.className="p-2";t.innerHTML="<strong>TA<\/strong>: "+n.ta+" g/L";r.appendChild(t)}if(n.so2){const t=document.createElement("div");t.className="p-2";t.innerHTML="<strong>Sulfite<\/strong>: "+n.so2+" mg/L";r.appendChild(t)}if(n.temp&&n.tempUom){const t=document.createElement("div");t.className="p-2";t.innerHTML="<strong>Temp<\/strong>: "+n.temp+" &deg;"+n.tempUom;r.appendChild(t)}i.appendChild(r);const f=document.createElement("div");if(f.className="d-flex ml-3",n.racked===!0){const n=document.createElement("div");n.className="p-2";n.innerHTML="<strong>Racked<\/strong>";f.appendChild(n)}if(n.filtered===!0){const n=document.createElement("div");n.className="p-2";n.innerHTML="<strong>Filtered<\/strong>";f.appendChild(n)}if(n.bottled===!0){const n=document.createElement("div");n.className="p-2";n.innerHTML="<strong>Bottled<\/strong>";f.appendChild(n)}if(i.appendChild(f),n.additions){const r=document.createElement("div");r.className="d-flex ml-3";r.innerHTML='<strong class="pl-2">Additions<\/strong>: ';const t=document.createElement("textarea");t.className="form-control border-0 pl-2 pt-0 bg-transparent";t.setAttribute("rows",3);t.setAttribute("disabled","");t.innerHTML=n.additions;r.appendChild(t);i.appendChild(r)}if(n.comments){const r=document.createElement("div");r.className="d-flex ml-3";r.innerHTML='<strong class="pl-2">Comments<\/strong>: ';const t=document.createElement("textarea");t.className="form-control border-0 pl-2 pt-0 bg-transparent";t.setAttribute("rows",3);t.setAttribute("disabled","");t.innerHTML=n.comments;r.appendChild(t);i.appendChild(r)}o.appendChild(i);document.getElementById("batchEntries").prepend(o)}localStorage.removeItem("latestEntryAdded")}var statusChart;$(document).ready(function(){localStorage.removeItem("latestEntryAdded");$("body").off("keypress","#batchInfo input");$("body").on("keypress","#batchInfo input",function(n){var r=$(this).val(),t=n.which?n.which:n.keyCode,i;return t>31&&(t===47||t<45||t>57)?!1:(i=1+r.indexOf("."),t===46&&i>0?!1:void 0)});$("body").off("paste","#batchInfo :input");$("body").on("paste","#batchInfo :input",function(){var n=$(this);setTimeout(function(){isNaN(parseFloat(n.val()))&&(showAlert("Only Numerical Characters allowed !",cssAlert_Warning,!0),setTimeout(function(){n.val(null)},2500))},5)});$("body").off("keypress","#batchTargets input");$("body").on("keypress","#batchTargets input",function(n){var r=$(this).val(),t=n.which?n.which:n.keyCode,i;return t>31&&(t===47||t<45||t>57)?!1:(i=1+r.indexOf("."),t===46&&i>0?!1:void 0)});$("body").off("paste","#batchTargets :input");$("body").on("paste","#batchTargets :input",function(){var n=$(this);setTimeout(function(){isNaN(parseFloat(n.val()))&&(showAlert("Only Numerical Characters allowed !",cssAlert_Warning,!0),setTimeout(function(){n.val(null)},2500))},5)});$("body").off("click",'button[name="editBatchDetailsButton"]');$("body").on("click",'button[name="editBatchDetailsButton"]',function(){var n=$(this).data("id");$("#editBatchId").val(n);$("#frmEditBatch").submit()});$("body").off("click",'button[name="showBatchEntryQuickButton"]');$("body").on("click",'button[name="showBatchEntryQuickButton"]',function(){var n=$(this).data("id");showAddEntry(n)});$("body").off("click",'button[name="showBatchEntryButton"]');$("body").on("click",'button[name="showBatchEntryButton"]',function(){var n=$(this).data("id");showAddEntry(n);$("#batchEntryModal").on("hidden.bs.modal",function(){var t=localStorage.getItem("latestEntryAdded"),n;t&&(n=JSON.parse(t),buildDisplayEntry(n),addToChart(n),updateStatus(n))})});$("body").off("click",'button[name="addBatchEntryButton"]');$("body").on("click",'button[name="addBatchEntryButton"]',function(){var n=$("#batchEntryModal_id").val();addBatchEntry(n)});$("body").off("click",'button[name="delBatchEntryButton"]');$("body").on("click",'button[name="delBatchEntryButton"]',function(){if(confirm("Are you sure?")){var n=$(this).data("id"),t=$(this).parent().parent().parent();deleteBatchEntry(n,t)}});if(window.location.href.lastIndexOf("EditBatch")>=0){var n=$("#updateBatchId").val();getStatusChart(n)}});